{% extends "base.html" %}
{% block title %}Resume Builder - AI Resume Builder{% endblock %}
{% block content %}
<div class="builder-container">
    <div class="builder-header">
        <h1>ü§ñ AI Resume Builder</h1>
        <p>Fill in your information and let AI enhance your content</p>
        <div class="template-selector">
            <label for="template-select">Template: </label>
            <select id="template-select">
                <option value="classic" {% if selected_template == 'classic' %}selected{% endif %}>Classic Professional</option>
                <option value="modern" {% if selected_template == 'modern' %}selected{% endif %}>Modern Professional</option>
                <option value="creative" {% if selected_template == 'creative' %}selected{% endif %}>Creative Professional</option>
            </select>
        </div>
        <!-- Progress Indicator - ADD AFTER template-selector -->
        <div class="progress-indicator">
            <div class="progress-header">
                <span class="progress-title">Resume Completion</span>
                <span class="progress-percentage">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: 0%"></div>
            </div>
            <div class="progress-sections">
                <div class="progress-section">
                    <div class="progress-icon incomplete" data-section="personal">‚óã</div>
                    <span>Personal</span>
                </div>
                <div class="progress-section">
                    <div class="progress-icon incomplete" data-section="summary">‚óã</div>
                    <span>Summary</span>
                </div>
                <div class="progress-section">
                    <div class="progress-icon incomplete" data-section="experience">‚óã</div>
                    <span>Experience</span>
                </div>
                <div class="progress-section">
                    <div class="progress-icon incomplete" data-section="education">‚óã</div>
                    <span>Education</span>
                </div>
                <div class="progress-section">
                    <div class="progress-icon incomplete" data-section="projects">‚óã</div>
                    <span>Projects</span>
                </div>
                <div class="progress-section">
                    <div class="progress-icon incomplete" data-section="skills">‚óã</div>
                    <span>Skills</span>
                </div>
            </div>
        </div>

    </div>
   
    <div class="builder-layout">
        <div class="builder-form">
            <form id="resume-form">
                <!-- Personal Information - ENHANCED -->
                <div class="form-section">
                    <h3>üë§ Personal Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name">Full Name *</label>
                            <input type="text" id="name" required value="{% if resume_data.personal_info %}{{ resume_data.personal_info.name }}{% endif %}">
                        </div>
                        <div class="form-group">
                            <label for="title">Target Job Title</label>
                            <input type="text" id="title" placeholder="e.g., Software Engineer" value="{% if resume_data.personal_info %}{{ resume_data.personal_info.title }}{% endif %}">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">Email Address *</label>
                            <input type="email" id="email" required value="{% if resume_data.personal_info %}{{ resume_data.personal_info.email }}{% endif %}">
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone Number</label>
                            <input type="tel" id="phone" value="{% if resume_data.personal_info %}{{ resume_data.personal_info.phone }}{% endif %}">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="location">Location</label>
                            <input type="text" id="location" placeholder="City, State" value="{% if resume_data.personal_info %}{{ resume_data.personal_info.location }}{% endif %}">
                        </div>
                        <div class="form-group">
                            <label for="linkedin">LinkedIn Profile</label>
                            <input type="url" id="linkedin" placeholder="https://linkedin.com/in/yourprofile" value="{% if resume_data.personal_info %}{{ resume_data.personal_info.linkedin }}{% endif %}">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="website">Portfolio/Website (Optional)</label>
                            <input type="url" id="website" placeholder="https://yourwebsite.com" value="{% if resume_data.personal_info %}{{ resume_data.personal_info.website }}{% endif %}">
                        </div>
                        <div class="form-group">
                            <label for="github">GitHub Profile (Optional)</label>
                            <input type="url" id="github" placeholder="https://github.com/yourusername" value="{% if resume_data.personal_info %}{{ resume_data.personal_info.github }}{% endif %}">
                        </div>
                    </div>
                    
                    <!-- ATS Score Preview - NEW FEATURE -->
                    <div class="ats-score-preview" id="ats-score-preview" style="display: none;">
                        <div class="score-header">
                            <h4>üéØ ATS Compatibility Score</h4>
                            <div class="score-circle">
                                <span class="score-value" id="ats-score">--</span>
                                <span class="score-max">/100</span>
                            </div>
                        </div>
                        <div class="score-details">
                            <div class="score-item">
                                <span class="score-label">Keywords:</span>
                                <span class="score-status" id="keywords-status">--</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">Sections:</span>
                                <span class="score-status" id="sections-status">--</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">Format:</span>
                                <span class="score-status" id="format-status">--</span>
                            </div>
                        </div>
                        <div class="score-suggestions" id="score-suggestions"></div>
                    </div>
                </div>


                <!-- Professional Summary -->
                <div class="form-section">
                    <h3>üìù Professional Summary</h3>
                    <div class="form-group ai-enhanced">
                        <label for="summary-input">Professional Summary</label>
                        <textarea id="summary-input" rows="4" placeholder="Write a brief summary of your professional background and career goals...">{{ resume_data.summary if resume_data.summary else '' }}</textarea>
                        <button type="button" class="btn-ai" onclick="getAISuggestion('summary')">ü§ñ AI Suggest</button>
                    </div>
                </div>

                <!-- Work Experience - Dynamic -->
                <div class="form-section">
                    <h3>üíº Work Experience</h3>
                    <div id="experience-container">
                        <!-- Experience entries will be dynamically added here -->
                    </div>
                    <div class="experience-actions">
                        <button type="button" id="add-experience-btn" class="btn btn-outline">
                            ‚ûï Add Experience
                        </button>
                    </div>
                </div>

                <!-- Education - Dynamic -->
                <div class="form-section">
                    <h3>üéì Education</h3>
                    <div id="education-container">
                        <!-- Education entries will be dynamically added here -->
                    </div>
                    <div class="education-actions">
                        <button type="button" id="add-education-btn" class="btn btn-outline">
                            ‚ûï Add Education
                        </button>
                    </div>
                </div>

                <!-- Projects - NEW DYNAMIC SECTION -->
                <div class="form-section">
                    <h3>üöÄ Projects</h3>
                    <div id="projects-container">
                        <!-- Project entries will be dynamically added here -->
                    </div>
                    <div class="projects-actions">
                        <button type="button" id="add-project-btn" class="btn btn-outline">
                            ‚ûï Add Project
                        </button>
                    </div>
                </div>
                

                <!-- Skills -->
                <div class="form-section">
                    <h3>üõ†Ô∏è Skills</h3>
                    <div class="form-group ai-enhanced">
                        <label for="skills-input">Skills (separate with commas)</label>
                        <textarea id="skills-input" rows="3" placeholder="List your technical and soft skills, separated by commas...">{{ resume_data.skills if resume_data.skills else '' }}</textarea>
                        <button type="button" class="btn-ai" onclick="getAISuggestion('skills')">ü§ñ AI Suggest</button>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="button" id="clear-btn" class="btn btn-warning">üóëÔ∏è Clear All</button>
                    <button type="button" id="save-btn" class="btn btn-secondary">üíæ Save Resume</button>
                    <button type="button" id="export-pdf-btn" class="btn btn-primary">üìÑ Export PDF</button>
                </div>
            </form>
        </div>

        <!-- Live Preview -->
        <div class="preview-panel">
            <div class="preview-header">
                <h3>üìã Live Preview</h3>
            </div>
            <div class="resume-preview {{ selected_template }}-template" id="resume-preview">
                <p style="text-align: center; color: #64748b; margin-top: 2rem;">
                    Your resume preview will appear here as you fill in the form
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
